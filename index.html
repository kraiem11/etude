<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ã‰tude - Test</title>
    <script src="https://sdk.minepi.com/pi-sdk.js" defer></script>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; background: #f4f4f4; }
        .status { padding: 10px; margin: 20px; border-radius: 8px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        button { padding: 15px 30px; font-size: 18px; cursor: pointer; background: #673ab7; color: white; border: none; border-radius: 25px; }
    </style>
</head>
<body>

    <h1>ØªØ·Ø¨ÙŠÙ‚ Ã‰tude ğŸ“š</h1>
    <div id="status-box" class="status">Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Pi Network...</div>
    
    <button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Pi</button>

    <script>
        <script>
    // 1. ØªÙ‡ÙŠØ¦Ø© Ù…ÙƒØªØ¨Ø© Pi ÙÙˆØ± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    const Pi = window.Pi;
    
    window.onload = function() {
        if (window.Pi) {
            try {
                Pi.init({ version: "2.0", sandbox: true });
                document.getElementById('status-box').innerText = "âœ… Ù…ÙƒØªØ¨Ø© Pi Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¹Ù…Ù„";
                document.getElementById('status-box').className = "status success";
            } catch (e) {
                console.error("Initialization error:", e);
            }
        }
    };

    // 2. Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
    async function login() {
        console.log("Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...");
        
        if (!window.Pi) {
            alert("Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…ÙƒØªØ¨Ø© Pi. Ø§ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Ù…ØªØµÙØ­ Pi.");
            return;
        }

        try {
            // Ø¥Ø¶Ø§ÙØ© Ø³Ø·Ø± Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø£Ù† Ø§Ù„Ø²Ø± Ø§Ø³ØªØ¬Ø§Ø¨ Ù„Ù„Ø¶ØºØ·
            document.querySelector('button').innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...";

            const scopes = ['username', 'payments'];
            
            // Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªÙŠ ØªÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
            const auth = await Pi.authenticate(scopes, (payment) => {
                console.log("Incomplete payment:", payment);
            });

            // Ø¥Ø°Ø§ Ù†Ø¬Ø­ Ø§Ù„Ø§ØªØµØ§Ù„
            document.getElementById('status-box').innerHTML = "âœ… Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ " + auth.user.username;
            alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ " + auth.user.username);
            document.querySelector('button').innerText = "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";

        } catch (err) {
            console.error("Auth error:", err);
            alert("ØªÙ†Ø¨ÙŠÙ‡: " + err.message);
            document.querySelector('button').innerText = "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Pi";
        }
    }
</script>

</body>
</html>
